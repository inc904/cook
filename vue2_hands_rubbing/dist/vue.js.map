{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observe {\n  constructor(data) {\n    // Object.defineProperty  只能劫持 已经存在的属性，增加的 删除的 都不会被劫持 （增加$set. $delete）\n    if (Array.isArray(data)) {\n      // 重写 7个数组 变异方法（会修改数组本身的方法）\n\n      /**\n       *\n       */\n      this.observeArray(data)\n    } else {\n      this.walk(data)\n    }\n\n    // this.walk(data)\n\n  }\n  walk(data) {\n    // 循环对象 对属性 依次劫持\n    Object.keys(data).forEach(key => {\n      // Object.defineProperty(data, data[key],{})\n      // ”重新定义“ 属性\n      defineReactive(data, key, data[key])\n    })\n  }\n  observeArray(data) {\n    data.forEach(item => observe(item))\n  }\n}\n\nexport function defineReactive(target, key, value) {\n  // Object.defineProperty(data, data[key],{})\n\n  if (arguments.length == 2) value = target[key]\n\n  observe(value)\n\n  Object.defineProperty(target, key, {\n    get() {\n      console.log('用户取值了')\n      return value\n    },\n    set(newValue) {\n      console.log('用户设置值了')\n      if (newValue === value) return\n      observe(newValue)\n      value = newValue\n    }\n  })\n}\n\nexport function observe(data) {\n  // 对data对象进行劫持\n\n  if (typeof data !== 'object' || data == null) return\n\n  // 如果 一个对象 被劫持过了，那就不需要再 劫持了，\n  // 判断对象是否被劫持， 增加了一个实例 来判断\n\n  return new Observe(data)\n}\n","import { observe } from './observe/index'\n\nexport function initState(vm) {\n  // 获取所有的选项\n  const opts = vm.$options\n  if (opts.data) {\n    initData(vm)\n  }\n}\n\nfunction proxy(vm, target, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[target][key]\n    },\n    set(newValue) {\n      vm[target][key] = newValue\n    }\n  })\n}\n\nfunction initData(vm) {\n  let data = vm.$options.data // data可能是函数或者对象\n  data = typeof data === 'function' ? data.call(vm) : data\n\n  vm._data = data\n  // 对数据进行劫持 Object.defineProperty\n  observe(data)\n\n  // 将 vm._data 用vm来代理\n  for (let key in data) {\n    proxy(vm, '_data', key)\n  }\n}\n","import { initState } from './state'\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options\n\n    // 初始化状态\n    initState(vm)\n  }\n}\n","import { initMixin } from './init'\n\nfunction Vue(options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\n\nexport default Vue\n"],"names":["Observe","data","Array","isArray","observeArray","walk","Object","keys","forEach","key","defineReactive","item","observe","target","value","arguments","length","defineProperty","get","console","log","set","newValue","initState","vm","opts","$options","initData","proxy","call","_data","initMixin","Vue","prototype","_init","options"],"mappings":"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"}