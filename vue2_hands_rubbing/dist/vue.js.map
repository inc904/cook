{"version":3,"file":"vue.js","sources":["../src/complier/parse.js","../src/complier/index.js","../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["// 对模板进行编译\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`\nconst startTagOpen = new RegExp(`^<${qnameCapture}`) // 匹配到的分组是一个 标签名 <xxx 匹配到的是开始 标签的名字\nconst endTag = new RegExp(`<\\\\/${qnameCapture}[^>]*>`) // 匹配的是 </xxxx> 最终匹配到的分组就是结束标签的名字\n// 第一个分组就是属性的key value 就是分组3、分组4、分组5\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/\nconst startTagClose = /^\\s*(\\/?)>/ // <div> <br/>\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // {{asdsada}} 匹配到的内容就是我们表达式的变量\n\n// console.log(startTagOpen)\n\nexport function parseHTML(html) {\n  const ELEMENT_TYPE = 1\n  const TEXT_TYPE = 1\n  const stack = [] // 用于存放元素的\n  let currentParent, root // 指向的是栈中的最后一个 ; 根节点\n  //  html最开始肯定是一个 <\n  while (html) {\n    /*\n      如果 textEnd 为0 说明是一个开始标签或者结束标签\n      如果 textEnd >0 说明是一个开始就是文本的结束位置\n    */\n    let textEnd = html.indexOf('<') // 如果 indexOf 中的索引是0 则说明是一个标签\n    if (textEnd == 0) {\n      const startTagMatch = parseStartTag() // 开始标签的匹配结果\n      if (startTagMatch) {\n        onStart(startTagMatch.tagName, startTagMatch.attrs)\n        continue\n      }\n\n      // // console.log('continue:', html)\n\n      // 在html截取后 只剩 标签的闭合为止的时候\n      let endTagMatch = html.match(endTag)\n      // console.log({ endTagMatch })\n      if (endTagMatch) {\n        advance(endTagMatch[0].length)\n        onEnd(endTagMatch.tagName)\n        continue\n      }\n    }\n\n    if (textEnd > 0) {\n      // 如果 indexOf 中的索引 大于0 则说明是一个 结束标签开始的文职 即文本的结束为止 hello</div>\n      // 有文本\n      let text = html.substring(0, textEnd) // 文本内容\n      if (text) {\n        onChars(text)\n        advance(text.length) // 解析到的文本\n        // console.log(333, html)\n      }\n    }\n\n    function createATSElement(tag, attrs) {\n      return {\n        tag,\n        type: ELEMENT_TYPE,\n        attrs,\n        children: [],\n        parent: null\n      }\n    }\n    function onStart(tag, attrs) {\n      let node = createATSElement(tag, attrs) // 创造一个 ast 节点\n      if (!root) {\n        // 看一下是否是 空树，如果是空树 则当前是输得根节点\n        root = node\n      }\n      if (currentParent) {\n        node.parent = currentParent\n        currentParent.children.push(node)\n      }\n      stack.push(node)\n      currentParent = node // currentParent 是栈中的最后一个\n    }\n    function onChars(text) {\n      text = text.replace(/\\s/g, '')\n      if (text) {\n        // 文本直接 放到 当前指向的节点中\n        currentParent?.children.push({\n          type: TEXT_TYPE,\n          text,\n          parent: currentParent\n        })\n      }\n    }\n    function onEnd(tag) {\n      //\n      stack.pop() // 将栈中的最后一个 弹出\n      currentParent = stack[stack.length - 1]\n\n      // 可以在这里校验 弹出的标签事不是 tag 是不是合法\n    }\n  }\n  console.log(root)\n  function advance(n) {\n    html = html.substring(n)\n  }\n  function parseStartTag() {\n    const start = html.match(startTagOpen)\n    // console.log({ start })\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: []\n      }\n      advance(start[0].length)\n      // console.log('startTagOpen=>>', match)\n\n      // 如果不是开始标签的结束就开始一直匹配下去\n      let attr, end\n      while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\n        // // console.log('attribute==>',html.match(attribute))\n        advance(attr[0].length)\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5] || true\n        })\n      }\n      // console.log(22, html)\n\n      if (end) {\n        advance(end[0].length)\n      }\n      // console.log({ match })\n      return match\n    }\n    return false // 不是开始标签\n  }\n  return root\n}\n","import { parseHTML } from './parse'\n\nexport function complieToFunction(template) {\n  /*\n    1. 将 template 转化成 ast 语法树\n    2. 生成 render方法 render 方法执行后的结果就是 虚拟DOM\n  */\n  let ast = parseHTML(template)\n  // console.log(template)\n  console.log({ ast })\n  function render() {\n    return h()\n  }\n  function h() {}\n}\n","// 我们希望重写数组中的部分方法\r\nlet oldArrayProto = Array.prototype\r\n\r\n// Array.prototype.push = function (){}  // 会被直接覆盖，Bad\r\n\r\n// 拷贝 一份新的出来\r\n\r\n// newArrayProto.__proto__ = oldArrayProto\r\nexport let newArrayProto = Object.create(oldArrayProto)\r\n\r\n// newArrayProto.push = function(){}\r\n\r\n// 找到所有的变异方法\r\nlet methods = ['push', 'pop', 'shift', 'unshift', 'reverse', 'sort', 'splice']\r\n\r\nmethods.forEach(method => {\r\n  // 重写数组的方法\r\n  newArrayProto[method] = function (...args) {\r\n    // 内部调用原来的方法， 函数的劫持， 切片编程\r\n    const result = oldArrayProto[method].call(this, ...args)\r\n\r\n    // 我们需要对新增的 数据 再次进行劫持\r\n    let inserted\r\n    let ob = this.__ob__\r\n    switch (method) {\r\n      case 'push':\r\n      case 'unshift':\r\n        inserted = args\r\n        break\r\n      case 'splice':\r\n        inserted = args.slice(2)\r\n      default:\r\n        break\r\n    }\r\n    console.log({inserted})\r\n    if(inserted){\r\n      // 对新增内容 再次进行观测\r\n      /*\r\n      需要用到 对数组的观测方法，考虑 从 this (data) 上引入\r\n      定义 自定义属性 data.__ob__，使得我们可以使用 Observe 上\r\n      的 数组观测方法\r\n     */\r\n      ob.observeArray(inserted)\r\n    }\r\n\r\n    return result\r\n  }\r\n})\r\n","import { newArrayProto } from './array'\r\n\r\nclass Observe {\r\n  constructor(data) {\r\n    // Object.defineProperty  只能劫持 已经存在的属性，增加的 删除的 都不会被劫持 （增加$set. $delete）\r\n    // data.__ob__ = this // 给数据加一个标识，如果数据上有 __ob__ 则说明这个属性被观测到了\r\n    Object.defineProperty(data, '__ob__', {\r\n      value: this,\r\n      enumerable: false // 将 __ob__ 变成不可枚举（循环的时候无法获取到）\r\n    })\r\n\r\n    if (Array.isArray(data)) {\r\n      // 重写 7个数组 变异方法（会修改数组本身的方法）\r\n\r\n      data.__proto__ = newArrayProto\r\n\r\n      this.observeArray(data)\r\n    } else {\r\n      this.walk(data)\r\n    }\r\n\r\n    // this.walk(data)\r\n  }\r\n  walk(data) {\r\n    // 循环对象 对属性 依次劫持\r\n    Object.keys(data).forEach(key => {\r\n      // Object.defineProperty(data, data[key],{})\r\n      // ”重新定义“ 属性\r\n      defineReactive(data, key, data[key])\r\n    })\r\n  }\r\n  observeArray(data) {\r\n    data.forEach(item => observe(item))\r\n  }\r\n}\r\n\r\nexport function defineReactive(target, key, value) {\r\n  // Object.defineProperty(data, data[key],{})\r\n\r\n  if (arguments.length == 2) value = target[key]\r\n\r\n  observe(value)\r\n\r\n  Object.defineProperty(target, key, {\r\n    get() {\r\n      console.log('用户取值了')\r\n      return value\r\n    },\r\n    set(newValue) {\r\n      console.log('用户设置值了')\r\n      if (newValue === value) return\r\n      observe(newValue)\r\n      value = newValue\r\n    }\r\n  })\r\n}\r\n\r\nexport function observe(data) {\r\n  // 对data对象进行劫持\r\n  if (typeof data !== 'object' || data == null) return\r\n\r\n  // 如果 一个对象 被劫持过了，那就不需要再 劫持了，\r\n  // 判断对象是否被劫持， 增加了一个实例 来判断\r\n  if (data.__ob__ instanceof Observe) {\r\n    return data.__ob__\r\n  }\r\n\r\n  return new Observe(data)\r\n}\r\n","import { observe } from './observe/index'\r\n\r\nexport function initState(vm) {\r\n  // 获取所有的选项\r\n  const opts = vm.$options\r\n  if (opts.data) {\r\n    initData(vm)\r\n  }\r\n}\r\n\r\nfunction proxy(vm, target, key) {\r\n  Object.defineProperty(vm, key, {\r\n    get() {\r\n      return vm[target][key]\r\n    },\r\n    set(newValue) {\r\n      vm[target][key] = newValue\r\n    }\r\n  })\r\n}\r\n\r\nfunction initData(vm) {\r\n  let data = vm.$options.data // data可能是函数或者对象\r\n  data = typeof data === 'function' ? data.call(vm) : data\r\n\r\n  vm._data = data\r\n  // 对数据进行劫持 Object.defineProperty\r\n  observe(data)\r\n\r\n  // 将 vm._data 用vm来代理\r\n  for (let key in data) {\r\n    proxy(vm, '_data', key)\r\n  }\r\n}\r\n","import { complieToFunction } from './complier'\nimport { initState } from './state'\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options\n\n    // 初始化状态\n    initState(vm)\n\n    if (options.el) {\n      vm.$mount(options.el)\n    }\n  }\n  Vue.prototype.$mount = function (el) {\n    console.log({ el })\n    const vm = this\n    el = document.querySelector(el)\n    console.log(2, { el })\n\n    let opts = vm.$options\n    if (!opts.render) {\n      // 先查找有没有render函数\n      let template // 没有render 看一下 是否写了 template ，没有写template 采用外部的template\n      // if (!opts.template && el) {\n      //   template = el.outerHTML\n      // } else {\n      //   if (el) {\n      //     // 如果有el 则采用模板的内容\n      //     template = opts.template\n      //   }\n      // }\n      if (el) {\n        template = opts.template ? opts.template : el.outerHTML\n      }\n\n      if (template) {\n        console.log('r0', template)\n        const render = complieToFunction(template)\n\n        opts.render = render\n        console.log('r', { render })\n      }\n      // console.log({ template })\n    }\n  }\n  // script 标签引用的 vue.global.js 这个编译过程是在浏览器运行的\n  // runtime是不再包含模板编译的，这个编译是打包的时候通过loader来转义 .vue 文件的\n  // 用 runtime的时候不能使用 template 配置项\n}\n","import { initMixin } from './init'\n\nfunction Vue(options) {\n  this._init(options)\n}\n\ninitMixin(Vue)\n\nexport default Vue\n"],"names":["ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","ELEMENT_TYPE","TEXT_TYPE","stack","currentParent","root","textEnd","indexOf","startTagMatch","parseStartTag","onStart","tagName","attrs","endTagMatch","match","advance","length","onEnd","text","substring","onChars","createATSElement","tag","type","children","parent","node","push","replace","pop","console","log","n","start","attr","end","name","value","complieToFunction","template","ast","oldArrayProto","Array","prototype","newArrayProto","Object","create","methods","forEach","method","args","result","call","inserted","ob","__ob__","slice","observeArray","Observe","data","defineProperty","enumerable","isArray","__proto__","walk","keys","key","defineReactive","item","observe","target","arguments","get","set","newValue","initState","vm","opts","$options","initData","proxy","_data","initMixin","Vue","_init","options","el","$mount","document","querySelector","render","outerHTML"],"mappings":"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"}